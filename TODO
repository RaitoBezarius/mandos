-*- org -*-

* mandos-client
** TODO [#B] use scandir(3) instead of readdir(3)
** TODO [#B] Prefix all debug output with "Mandos plugin " + program_invocation_short_name
** TODO use error() instead of perror()
** TODO [#B] Retry a server which has a non-definite reply:
*** A closed connection during the TLS handshake
*** A TCP timeout
** TODO [#B] Use capabilities instead of seteuid().
** TODO use EX_* from <sysexits.h>

* splashy
** TODO [#B] use scandir(3) instead of readdir(3)
** TODO [#B] Prefix all debug output with "Mandos plugin " + program_invocation_short_name
** TODO use error() instead of perror()

* usplash
** TODO [#B] use scandir(3) instead of readdir(3)
** TODO [#B] Prefix all debug output with "Mandos plugin " + program_invocation_short_name
** TODO use error() instead of perror()
** TODO use EX_* from <sysexits.h>

* askpass-fifo
** TODO [#B] Prefix all debug output with "Mandos plugin " + program_invocation_short_name
** TODO use error() instead of perror()
** TODO [#B] Drop privileges after opening FIFO.

* password-prompt
** TODO [#B] Prefix all debug output with "Mandos plugin " + program_invocation_short_name
** TODO use error() instead of perror()
** TODO use EX_* from <sysexits.h>

* TODO passdev

* plugin-runner
** TODO [#B] use scandir(3) instead of readdir(3)
** TODO [#C] use same file name rules as run-parts(8)
** TODO use EX_* from <sysexits.h>
** TODO use error() instead of perror()

* mandos (server)
** TODO [#B] Log level				:BUGS:
** TODO /etc/mandos/clients.d/*.conf
   Watch this directory and add/remove/update clients?
** TODO config for TXT record
** TODO [#B] Run-time communication with server :BUGS:
   Probably using D-Bus
*** Client class
*** Main server
    + SetLogLevel
      syslogger.setLevel(logging.WARNING)
    + [[http://log.ometer.com/2007-05.html][Best D-Bus practices]]
** TODO Implement --foreground			:BUGS:
   [[info:standards:Option%20Table][Table of Long Options]]
** TODO Implement --socket
   [[info:standards:Option%20Table][Table of Long Options]]
** TODO Date+time on console log messages	:BUGS:
   Is this the default?
** TODO DBusServiceObjectUsingSuper
** TODO Global enable/disable flag
** TODO By-client countdown on secrets given
** TODO Fix problem with fsck taking a really long time
   Whenever a client successfully gets a secret it could get a
   one-time timeout boost to allow for an fsck-incurred delay
** TODO Delay before client receives key
   This would give an operator opportunity to cancel the request if
   desired.
** TODO Client manual approval mode
   A client needs manual approval on the server before it gets the
   secret
** TODO Persistent state
   /var/lib/mandos/*

* mandos.xml
** [[file:mandos.xml::XXX][Document D-Bus interface]]

* Provide and install /etc/dbus-1/system.d/mandos.conf

* mandos-ctl
*** Handle "no D-Bus server" and/or "no Mandos server found" better
*** [#B] --dump option

* TODO mandos-dispatch
  Listens for specified D-Bus signals and spawns shell commands with
  arguments.

* mandos-monitor
** D-Bus main loop w/ signal receiver
** Urwid client data displayer
*** Urwid scaffolding
*** Client Widgets
*** Properties popup

* mandos-keygen
** TODO Loop until passwords match when run interactively
** TODO "--secfile" option
   Using the "secfile" option instead of "secret"
** TODO [#B] "--test" option
   For testing decryption before rebooting.

* Makefile
** Implement DEB_BUILD_OPTIONS
   http://www.debian.org/doc/debian-policy/ch-source.html#s-debianrules-options

* Package
** /usr/share/initramfs-tools/hooks/mandos
*** TODO [#C] use same file name rules as run-parts(8)
*** TODO [#C] Do not install in initrd.img if configured not to.
    Use "/etc/initramfs-tools/hooksconf.d/mandos"?
** TODO [#C] /etc/bash_completion.d/mandos
   From XML sources directly?


#+STARTUP: showall
